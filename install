#!/bin/bash
#expects a dir location where the backup files are stored

#set -e 

stow -t ~ dircolors
stow -t ~ tmux
stow -t ~ fonts
#stow -t ~ gtk-3.0
stow -t ~ ranger
stow -t ~ gitconfig
stow -t ~ myscripts
stow -t ~ latexmk
stow -t ~ freemind
stow -t ~ mlterm
stow -t ~ zathura
stow -t ~ background
stow -t ~ mpv
stow -t ~ feh
stow -t ~ -d  intellij -S ideavim
stow -t ~ ctags
stow -t ~ tig
stow -t ~ tldr
stow -t ~ notes
stow -t ~ urxvt


#set extentions for urxvt
mkdir -p ~/.urxvt/ext
curl -s https://raw.githubusercontent.com/majutsushi/urxvt-font-size/master/font-size > ~/.urxvt/ext/font-size
curl -s https://raw.githubusercontent.com/muennich/urxvt-perls/master/keyboard-select > ~/.urxvt/ext/keyboard-select

#set mlterm vaafont file
if [ ! -f ~/.mlterm/vaafont ]; then
    ln -s ~/.mlterm/vaafont.template ~/.mlterm/vaafont
fi

#shell
stow -t ~ shell
grep "mybashrc" ~/.bashrc > /dev/null 2>&1 
exists=$?
if [ "$exists" -ne 0 ]; then
    echo "source ~/.mybashrc" >> ~/.bashrc
fi

#install vim plugins and fzf
stow -t ~ vim
if [ ! -d ~/.vim/bundle/Vundle.vim ]; then
    git clone https://github.com/VundleVim/Vundle.vim.git ~/.vim/bundle/Vundle.vim
fi

read -p "Do you want Vundle to install plugins now ([y])? " -n 1 -r
echo    
if [[ $REPLY =~ ^[Yy]$ ]]
then
    vim +PluginInstall +qall

    if [ -d ~/.vim/bundle/YouCompleteMe ]; then
        read -p "Compile YouCompleteMe Binaries ([y])? " -n 1 -r
        echo    
        if [[ $REPLY =~ ^[Yy]$ ]]
        then
            python ~/.vim/bundle/YouCompleteMe/install.py
        fi
    fi

    if [ -d ~/.vim/bundle/fzf ]; then
        read -p "Do you want to install fzf ([y])? " -n 1 -r
        echo    
        if [[ $REPLY =~ ^[Yy]$ ]]
        then
            source ~/.vim/bundle/fzf/install
        fi
    fi
fi


echo "Done"
