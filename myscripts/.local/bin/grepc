#!/bin/bash

if [ "$#" -lt 2 ]; then
    echo "Usage command {search-term} [search-terms] {filename}"
    exit
fi


firstpart="grep --line-buffered --color=always \""
secondpart=""

#Color	Foreground	Background
#Black	    30	               40
#Red	    31	               41
#Green	    32	               42
#Yellow	    33	               43
#Blue	    34	               44
#Magenta    35	               45
#Cyan	    36	               46
#White	    37	               47
colors=(
"GREP_COLOR='1;37;40'    grep --color=always --line-buffered"
"GREP_COLOR='1;37;41'    grep --color=always --line-buffered"
"GREP_COLOR='1;37;42'    grep --color=always --line-buffered"
"GREP_COLOR='1;37;43'    grep --color=always --line-buffered"
"GREP_COLOR='1;37;44'    grep --color=always --line-buffered"
"GREP_COLOR='1;37;45'    grep --color=always --line-buffered"
"GREP_COLOR='1;37;46'    grep --color=always --line-buffered"
"GREP_COLOR='1;37;47'    grep --color=always --line-buffered"
)
#colors=(
#"GREP_COLOR='1;36'    grep --color=always --line-buffered"
#"GREP_COLOR='1;35' grep --color=always --line-buffered"
#"GREP_COLOR='1;34'    grep --color=always --line-buffered"
#"GREP_COLOR='1;33'  grep --color=always --line-buffered"
#"GREP_COLOR='1;32'   grep --color=always --line-buffered"
#"GREP_COLOR='1;31'     grep --color=always --line-buffered"
#)

size=`expr $# - 1`
fileIndex="$#"

for i in $(seq 1 $size);
do
    if [[ "$i" -ne 1 && "$i" -le $size ]]; then
        secondpart="$secondpart|"
        firstpart="$firstpart\|"
    fi

    grp=${colors[$i%${#colors[@]}]}
    secondpart="$secondpart $grp \"^\|${!i}\" "
    firstpart="$firstpart${!i}"
done
firstpart="$firstpart\" ${!fileIndex}  "
command="$firstpart | $secondpart "
#echo "$command"
eval $command


